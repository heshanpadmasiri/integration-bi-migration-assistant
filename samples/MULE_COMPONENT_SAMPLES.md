###### This markdown file is AUTO-GENERATED by the test suite. Do not modify manually. ######

# Sample Input and Output

The `mule-to-ballerina-migration-assistant` project includes sample input and output files to demonstrate the conversion process. These samples are located in the `src/test/resources/blocks/mule3` directory.

## Async

- ### Simple Async

**Input (simple_async.xml):**
```xml
<mule xmlns:http="http://www.mulesoft.org/schema/mule/http"
      xmlns:dw="http://www.mulesoft.org/schema/mule/ee/dw"
      xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:spring="http://www.springframework.org/schema/beans" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/dw http://www.mulesoft.org/schema/mule/ee/dw/current/dw.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd">
    <flow name="mainFlow">
        <set-payload value="Hello" />
        <async>
            <logger level="INFO" message="Doing something in background: #[payload]" />
        </async>
        <logger level="INFO" message="Main flow continues immediately." />
    </flow>
</mule>

```
**Output (simple_async.bal):**
```ballerina
import ballerina/log;

public type Context record {|
    anydata payload;
|};

public function mainFlow(Context ctx) {

    // set payload
    string _payload0_ = "Hello";
    ctx.payload = _payload0_;

    // async operation
    _ = start _async0_(ctx);
    log:printInfo("Main flow continues immediately.");
}

public function _async0_(Context ctx) {
    log:printInfo(string `Doing something in background: ${ctx.payload.toString()}`);
}

```

## Catch Exception Strategy

- ### Basic Catch Exception Strategy

**Input (basic_catch_exception_strategy.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:tracking="http://www.mulesoft.org/schema/mule/ee/tracking" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/tracking http://www.mulesoft.org/schema/mule/ee/tracking/current/mule-tracking-ee.xsd">
    <flow name="demoFlow">
        <logger message="xxx: logger invoked via http end point" level="INFO" doc:name="Logger"/>
        <catch-exception-strategy doc:name="Catch Exception Strategy">
            <logger message="xxx: exception caught" level="INFO" doc:name="Logger"/>
            <logger message="xxx: end of catch flow reached" level="INFO" doc:name="Logger"/>
        </catch-exception-strategy>
    </flow>
</mule>

```
**Output (basic_catch_exception_strategy.bal):**
```ballerina
import ballerina/log;

public type Context record {|
    anydata payload;
|};

public function demoFlow(Context ctx) {
    do {
        log:printInfo("xxx: logger invoked via http end point");
    } on fail {
        log:printInfo("xxx: exception caught");
        log:printInfo("xxx: end of catch flow reached");
    }
}

```

- ### Catch Exception With Http Listener Source

**Input (catch_exception_with_http_listener_source.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:tracking="http://www.mulesoft.org/schema/mule/ee/tracking" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/tracking http://www.mulesoft.org/schema/mule/ee/tracking/current/mule-tracking-ee.xsd">
    <http:listener-config name="config" host="0.0.0.0" port="8081"  doc:name="HTTP Listener Configuration" basePath="mule3"/>
    <flow name="demoFlow">
        <http:listener config-ref="config" path="/"  doc:name="HTTP" allowedMethods="GET"/>
        <logger message="xxx: logger invoked via http end point" level="INFO" doc:name="Logger"/>
        <catch-exception-strategy doc:name="Catch Exception Strategy">
            <logger message="xxx: exception caught" level="INFO" doc:name="Logger"/>
            <logger message="xxx: end of catch flow reached" level="INFO" doc:name="Logger"/>
        </catch-exception-strategy>
    </flow>
</mule>

```
**Output (catch_exception_with_http_listener_source.bal):**
```ballerina
import ballerina/http;
import ballerina/log;

public type InboundProperties record {|
    http:Response response;
    http:Request request;
    map<string> uriParams;
|};

public type Context record {|
    anydata payload;
    InboundProperties inboundProperties;
|};

public listener http:Listener config = new (8081, {host: "0.0.0.0"});

service /mule3 on config {
    Context ctx;

    function init() {
        self.ctx = {payload: (), inboundProperties: {response: new, request: new, uriParams: {}}};
    }

    resource function get .(http:Request request) returns http:Response|error {
        self.ctx.inboundProperties.request = request;
        return _invokeEndPoint0_(self.ctx);
    }
}

public function _invokeEndPoint0_(Context ctx) returns http:Response|error {
    do {
        log:printInfo("xxx: logger invoked via http end point");
    } on fail {
        log:printInfo("xxx: exception caught");
        log:printInfo("xxx: end of catch flow reached");
    }

    ctx.inboundProperties.response.setPayload(ctx.payload);
    return ctx.inboundProperties.response;
}

```

## Choice

- ### Basic Choice

**Input (basic_choice.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:file="http://www.mulesoft.org/schema/mule/file" xmlns:tracking="http://www.mulesoft.org/schema/mule/ee/tracking" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/tracking http://www.mulesoft.org/schema/mule/ee/tracking/current/mule-tracking-ee.xsd
http://www.mulesoft.org/schema/mule/file http://www.mulesoft.org/schema/mule/file/current/mule-file.xsd">
    <flow name="muleProject">
        <set-variable variableName="age" value="#[29]" doc:name="Variable"/>
        <choice doc:name="Choice">
            <when expression="#[flowVars.age > 18]">
                <logger message="Adult detected: Age is #[flowVars.age] years." level="INFO" doc:name="Logger"/>
            </when>
            <otherwise>
                <logger message="Minor detected: Age is flowVars.age years." level="INFO" doc:name="Logger"/>
            </otherwise>
        </choice>
    </flow>
</mule>

```
**Output (basic_choice.bal):**
```ballerina
import ballerina/log;

public type FlowVars record {|
    int age?;
|};

public type Context record {|
    anydata payload;
    FlowVars flowVars;
|};

public function muleProject(Context ctx) {
    ctx.flowVars.age = 29;
    if ctx.flowVars.age > 18 {
        log:printInfo(string `Adult detected: Age is ${ctx.flowVars.age.toString()} years.`);
    } else {
        log:printInfo("Minor detected: Age is flowVars.age years.");
    }
}

```

- ### Choice With Http Listener Source

**Input (choice_with_http_listener_source.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:file="http://www.mulesoft.org/schema/mule/file" xmlns:tracking="http://www.mulesoft.org/schema/mule/ee/tracking" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/tracking http://www.mulesoft.org/schema/mule/ee/tracking/current/mule-tracking-ee.xsd
http://www.mulesoft.org/schema/mule/file http://www.mulesoft.org/schema/mule/file/current/mule-file.xsd">
    <http:listener-config name="config" host="0.0.0.0" port="8081"  doc:name="HTTP Listener Configuration" basePath="mule3"/>
    <flow name="muleProject">
        <http:listener config-ref="config" path="/"  doc:name="HTTP" allowedMethods="GET"/>
        <set-variable variableName="marks" value="#[73]" doc:name="Variable"/>
        <choice doc:name="Choice">
            <when expression="#[flowVars.marks > 75]">
                <logger message="You have scored #[flowVars.marks]. Your grade is A." level="INFO" doc:name="Logger"/>
            </when>
            <when expression="#[flowVars.marks > 65]">
                <logger message="You have scored #[flowVars.marks]. Your grade is B." level="INFO" doc:name="Logger"/>
            </when>
            <when expression="#[flowVars.marks > 55]">
                <logger message="You have scored #[flowVars.marks]. Your grade is C." level="INFO" doc:name="Logger"/>
            </when>
            <otherwise>
                <logger message="You have scored #[flowVars.marks]. Your grade is F." level="INFO" doc:name="Logger"/>
            </otherwise>
        </choice>
    </flow>
</mule>

```
**Output (choice_with_http_listener_source.bal):**
```ballerina
import ballerina/http;
import ballerina/log;

public type FlowVars record {|
    int marks?;
|};

public type InboundProperties record {|
    http:Response response;
    http:Request request;
    map<string> uriParams;
|};

public type Context record {|
    anydata payload;
    FlowVars flowVars;
    InboundProperties inboundProperties;
|};

public listener http:Listener config = new (8081, {host: "0.0.0.0"});

service /mule3 on config {
    Context ctx;

    function init() {
        self.ctx = {payload: (), flowVars: {}, inboundProperties: {response: new, request: new, uriParams: {}}};
    }

    resource function get .(http:Request request) returns http:Response|error {
        self.ctx.inboundProperties.request = request;
        return _invokeEndPoint0_(self.ctx);
    }
}

public function _invokeEndPoint0_(Context ctx) returns http:Response|error {
    ctx.flowVars.marks = 73;
    if ctx.flowVars.marks > 75 {
        log:printInfo(string `You have scored ${ctx.flowVars.marks.toString()}. Your grade is A.`);
    } else if ctx.flowVars.marks > 65 {
        log:printInfo(string `You have scored ${ctx.flowVars.marks.toString()}. Your grade is B.`);
    } else if ctx.flowVars.marks > 55 {
        log:printInfo(string `You have scored ${ctx.flowVars.marks.toString()}. Your grade is C.`);
    } else {
        log:printInfo(string `You have scored ${ctx.flowVars.marks.toString()}. Your grade is F.`);
    }

    ctx.inboundProperties.response.setPayload(ctx.payload);
    return ctx.inboundProperties.response;
}

```

- ### Choice With Multiple Conditions

**Input (choice_with_multiple_conditions.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:file="http://www.mulesoft.org/schema/mule/file" xmlns:tracking="http://www.mulesoft.org/schema/mule/ee/tracking" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/tracking http://www.mulesoft.org/schema/mule/ee/tracking/current/mule-tracking-ee.xsd
http://www.mulesoft.org/schema/mule/file http://www.mulesoft.org/schema/mule/file/current/mule-file.xsd">
    <flow name="muleProject">
        <set-variable variableName="marks" value="#[73]" doc:name="Variable"/>
        <choice doc:name="Choice">
            <when expression="#[flowVars.marks > 75]">
                <logger message="You have scored #[flowVars.marks]. Your grade is A." level="INFO" doc:name="Logger"/>
            </when>
            <when expression="#[flowVars.marks > 65]">
                <logger message="You have scored #[flowVars.marks]. Your grade is B." level="INFO" doc:name="Logger"/>
            </when>
            <when expression="#[flowVars.marks > 55]">
                <logger message="You have scored #[flowVars.marks]. Your grade is C." level="INFO" doc:name="Logger"/>
            </when>
            <otherwise>
                <logger message="You have scored #[flowVars.marks]. Your grade is F." level="INFO" doc:name="Logger"/>
            </otherwise>
        </choice>
    </flow>
</mule>

```
**Output (choice_with_multiple_conditions.bal):**
```ballerina
import ballerina/log;

public type FlowVars record {|
    int marks?;
|};

public type Context record {|
    anydata payload;
    FlowVars flowVars;
|};

public function muleProject(Context ctx) {
    ctx.flowVars.marks = 73;
    if ctx.flowVars.marks > 75 {
        log:printInfo(string `You have scored ${ctx.flowVars.marks.toString()}. Your grade is A.`);
    } else if ctx.flowVars.marks > 65 {
        log:printInfo(string `You have scored ${ctx.flowVars.marks.toString()}. Your grade is B.`);
    } else if ctx.flowVars.marks > 55 {
        log:printInfo(string `You have scored ${ctx.flowVars.marks.toString()}. Your grade is C.`);
    } else {
        log:printInfo(string `You have scored ${ctx.flowVars.marks.toString()}. Your grade is F.`);
    }
}

```

## Choice Exception Strategy

- ### Basic Choice Exception Strategy

**Input (basic_choice_exception_strategy.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:tracking="http://www.mulesoft.org/schema/mule/ee/tracking" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/tracking http://www.mulesoft.org/schema/mule/ee/tracking/current/mule-tracking-ee.xsd">
    <flow name="demoFlow">
        <logger message="xxx: main flow logger invoked" level="INFO" doc:name="Logger"/>
        <choice-exception-strategy doc:name="Choice Exception Strategy">
            <catch-exception-strategy doc:name="Catch Exception Strategy" when="condition1">
                <logger message="xxx: first catch condition invoked" level="INFO" doc:name="Logger"/>
            </catch-exception-strategy>
            <catch-exception-strategy doc:name="Catch Exception Strategy" when="condition2">
                <logger message="xxx: second catch condition invoked" level="INFO" doc:name="Logger"/>
            </catch-exception-strategy>
            <catch-exception-strategy doc:name="Catch Exception Strategy">
                <logger message="xxx: generic catch condition invoked" level="INFO" doc:name="Logger"/>
            </catch-exception-strategy>
        </choice-exception-strategy>
    </flow>
</mule>

```
**Output (basic_choice_exception_strategy.bal):**
```ballerina
import ballerina/log;

public type Context record {|
    anydata payload;
|};

public function demoFlow(Context ctx) {
    do {
        log:printInfo("xxx: main flow logger invoked");
    } on fail error e {
        if "condition1" {
            log:printInfo("xxx: first catch condition invoked");
        } else if "condition2" {
            log:printInfo("xxx: second catch condition invoked");
        } else {
            log:printInfo("xxx: generic catch condition invoked");
        }
    }
}

```

- ### Choice Exception With Http Listener Source

**Input (choice_exception_with_http_listener_source.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:tracking="http://www.mulesoft.org/schema/mule/ee/tracking" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/tracking http://www.mulesoft.org/schema/mule/ee/tracking/current/mule-tracking-ee.xsd">
    <http:listener-config name="config" host="0.0.0.0" port="8081"  doc:name="HTTP Listener Configuration" basePath="mule3"/>
    <flow name="demoFlow">
        <http:listener config-ref="config" path="/"  doc:name="HTTP" allowedMethods="GET"/>
        <logger message="xxx: logger invoked via http end point" level="INFO" doc:name="Logger"/>
        <choice-exception-strategy doc:name="Choice Exception Strategy">
            <catch-exception-strategy doc:name="Catch Exception Strategy" when="condition1">
                <logger message="xxx: first catch condition invoked" level="INFO" doc:name="Logger"/>
            </catch-exception-strategy>
            <catch-exception-strategy doc:name="Catch Exception Strategy" when="condition2">
                <logger message="xxx: second catch condition invoked" level="INFO" doc:name="Logger"/>
            </catch-exception-strategy>
            <catch-exception-strategy doc:name="Catch Exception Strategy">
                <logger message="xxx: generic catch condition invoked" level="INFO" doc:name="Logger"/>
            </catch-exception-strategy>
        </choice-exception-strategy>
    </flow>
</mule>

```
**Output (choice_exception_with_http_listener_source.bal):**
```ballerina
import ballerina/http;
import ballerina/log;

public type InboundProperties record {|
    http:Response response;
    http:Request request;
    map<string> uriParams;
|};

public type Context record {|
    anydata payload;
    InboundProperties inboundProperties;
|};

public listener http:Listener config = new (8081, {host: "0.0.0.0"});

service /mule3 on config {
    Context ctx;

    function init() {
        self.ctx = {payload: (), inboundProperties: {response: new, request: new, uriParams: {}}};
    }

    resource function get .(http:Request request) returns http:Response|error {
        self.ctx.inboundProperties.request = request;
        return _invokeEndPoint0_(self.ctx);
    }
}

public function _invokeEndPoint0_(Context ctx) returns http:Response|error {
    do {
        log:printInfo("xxx: logger invoked via http end point");
    } on fail error e {
        if "condition1" {
            log:printInfo("xxx: first catch condition invoked");
        } else if "condition2" {
            log:printInfo("xxx: second catch condition invoked");
        } else {
            log:printInfo("xxx: generic catch condition invoked");
        }
    }

    ctx.inboundProperties.response.setPayload(ctx.payload);
    return ctx.inboundProperties.response;
}

```

## Database Connector

- ### Basic Db Select

**Input (basic_db_select.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:db="http://www.mulesoft.org/schema/mule/db" xmlns:json="http://www.mulesoft.org/schema/mule/json" xmlns:tracking="http://www.mulesoft.org/schema/mule/ee/tracking" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/tracking http://www.mulesoft.org/schema/mule/ee/tracking/current/mule-tracking-ee.xsd
http://www.mulesoft.org/schema/mule/db http://www.mulesoft.org/schema/mule/db/current/mule-db.xsd
http://www.mulesoft.org/schema/mule/json http://www.mulesoft.org/schema/mule/json/current/mule-json.xsd">
    <http:listener-config name="config" host="0.0.0.0" port="8081"  doc:name="HTTP Listener Configuration" basePath="mule3"/>
    <db:mysql-config name="MySQL_Configuration" host="localhost" port="3306" user="root" password="admin123" database="test_db" doc:name="MySQL Configuration"/>
    <flow name="demoFlow">
        <http:listener config-ref="config" path="/" allowedMethods="GET" doc:name="HTTP"/>
        <db:select config-ref="MySQL_Configuration" doc:name="Database">
            <db:parameterized-query><![CDATA[SELECT * FROM users;]]></db:parameterized-query>
        </db:select>
    </flow>
</mule>

```
**Output (basic_db_select.bal):**
```ballerina
import ballerina/http;
import ballerina/sql;
import ballerinax/mysql;
import ballerinax/mysql.driver as _;

public type InboundProperties record {|
    http:Response response;
    http:Request request;
    map<string> uriParams;
|};

public type Context record {|
    anydata payload;
    InboundProperties inboundProperties;
|};

public type Record record {
};

mysql:Client MySQL_Configuration = check new ("localhost", "root", "admin123", "test_db", 3306);
public listener http:Listener config = new (8081, {host: "0.0.0.0"});

service /mule3 on config {
    Context ctx;

    function init() {
        self.ctx = {payload: (), inboundProperties: {response: new, request: new, uriParams: {}}};
    }

    resource function get .(http:Request request) returns http:Response|error {
        self.ctx.inboundProperties.request = request;
        return _invokeEndPoint0_(self.ctx);
    }
}

public function _invokeEndPoint0_(Context ctx) returns http:Response|error {

    // database operation
    sql:ParameterizedQuery _dbQuery0_ = `SELECT * FROM users;`;
    stream<Record, sql:Error?> _dbStream0_ = MySQL_Configuration->query(_dbQuery0_);
    Record[] _dbSelect0_ = check from Record _iterator_ in _dbStream0_
        select _iterator_;
    ctx.payload = _dbSelect0_;

    ctx.inboundProperties.response.setPayload(ctx.payload);
    return ctx.inboundProperties.response;
}

```

- ### Db Select Query From Template

**Input (db_select_query_from_template.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:db="http://www.mulesoft.org/schema/mule/db" xmlns:json="http://www.mulesoft.org/schema/mule/json" xmlns:tracking="http://www.mulesoft.org/schema/mule/ee/tracking" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/tracking http://www.mulesoft.org/schema/mule/ee/tracking/current/mule-tracking-ee.xsd
http://www.mulesoft.org/schema/mule/db http://www.mulesoft.org/schema/mule/db/current/mule-db.xsd
http://www.mulesoft.org/schema/mule/json http://www.mulesoft.org/schema/mule/json/current/mule-json.xsd">
    <http:listener-config name="config" host="0.0.0.0" port="8081"  doc:name="HTTP Listener Configuration" basePath="mule3"/>
    <db:mysql-config name="MySQL_Configuration" host="localhost" port="3306" user="root" password="admin123" database="test_db" doc:name="MySQL Configuration"/>
    <db:template-query name="Template_Select_Query" doc:name="Template Query">
        <db:parameterized-query><![CDATA[SELECT * FROM users;]]></db:parameterized-query>
    </db:template-query>
    <flow name="demoFlow">
        <http:listener config-ref="config" path="/" allowedMethods="GET" doc:name="HTTP"/>
        <db:select config-ref="MySQL_Configuration" doc:name="Database">
            <db:template-query-ref name="Template_Select_Query"/>
        </db:select>
    </flow>
</mule>

```
**Output (db_select_query_from_template.bal):**
```ballerina
import ballerina/http;
import ballerina/sql;
import ballerinax/mysql;
import ballerinax/mysql.driver as _;

public type InboundProperties record {|
    http:Response response;
    http:Request request;
    map<string> uriParams;
|};

public type Context record {|
    anydata payload;
    InboundProperties inboundProperties;
|};

public type Record record {
};

mysql:Client MySQL_Configuration = check new ("localhost", "root", "admin123", "test_db", 3306);
sql:ParameterizedQuery Template_Select_Query = `SELECT * FROM users;`;
public listener http:Listener config = new (8081, {host: "0.0.0.0"});

service /mule3 on config {
    Context ctx;

    function init() {
        self.ctx = {payload: (), inboundProperties: {response: new, request: new, uriParams: {}}};
    }

    resource function get .(http:Request request) returns http:Response|error {
        self.ctx.inboundProperties.request = request;
        return _invokeEndPoint0_(self.ctx);
    }
}

public function _invokeEndPoint0_(Context ctx) returns http:Response|error {

    // database operation
    sql:ParameterizedQuery _dbQuery0_ = Template_Select_Query;
    stream<Record, sql:Error?> _dbStream0_ = MySQL_Configuration->query(_dbQuery0_);
    Record[] _dbSelect0_ = check from Record _iterator_ in _dbStream0_
        select _iterator_;
    ctx.payload = _dbSelect0_;

    ctx.inboundProperties.response.setPayload(ctx.payload);
    return ctx.inboundProperties.response;
}

```

## Expression Component

- ### Simple Expression Component

**Input (simple_expression_component.xml):**
```xml
<mule xmlns:http="http://www.mulesoft.org/schema/mule/http"
      xmlns:dw="http://www.mulesoft.org/schema/mule/ee/dw"
      xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:spring="http://www.springframework.org/schema/beans" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/dw http://www.mulesoft.org/schema/mule/ee/dw/current/dw.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd">
    <flow name="combineFlowVarsAndPayloadFlow">
        <set-variable variableName="name" value="Alice"/>
        <set-payload value="Welcome"/>
        <expression-component>
            <![CDATA[
                flowVars.name = "Alice";
                payload = "Hello " + flowVars.name;
            ]]>
        </expression-component>
        <logger message="Message: #[payload]" level="INFO"/>
    </flow>
</mule>

```
**Output (simple_expression_component.bal):**
```ballerina
import ballerina/log;

public type FlowVars record {|
    string name?;
|};

public type Context record {|
    anydata payload;
    FlowVars flowVars;
|};

public function combineFlowVarsAndPayloadFlow(Context ctx) {
    ctx.flowVars.name = "Alice";

    // set payload
    string _payload0_ = "Welcome";
    ctx.payload = _payload0_;
    ctx.flowVars.name = "Alice";
    ctx.payload = "Hello " + ctx.flowVars.name;
    log:printInfo(string `Message: ${ctx.payload.toString()}`);
}

```

## Flow

- ### Basic Flow

**Input (basic_flow.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:tracking="http://www.mulesoft.org/schema/mule/ee/tracking" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/tracking http://www.mulesoft.org/schema/mule/ee/tracking/current/mule-tracking-ee.xsd">
    <http:listener-config name="config" host="0.0.0.0" port="8081"  doc:name="HTTP Listener Configuration" basePath="mule3"/>
    <flow name="demoFlow">
        <http:listener config-ref="config" path="/"  doc:name="HTTP" allowedMethods="GET"/>
        <logger message="xxx: logger invoked via http end point" level="INFO" doc:name="Logger"/>
    </flow>
</mule>

```
**Output (basic_flow.bal):**
```ballerina
import ballerina/http;
import ballerina/log;

public type InboundProperties record {|
    http:Response response;
    http:Request request;
    map<string> uriParams;
|};

public type Context record {|
    anydata payload;
    InboundProperties inboundProperties;
|};

public listener http:Listener config = new (8081, {host: "0.0.0.0"});

service /mule3 on config {
    Context ctx;

    function init() {
        self.ctx = {payload: (), inboundProperties: {response: new, request: new, uriParams: {}}};
    }

    resource function get .(http:Request request) returns http:Response|error {
        self.ctx.inboundProperties.request = request;
        return _invokeEndPoint0_(self.ctx);
    }
}

public function _invokeEndPoint0_(Context ctx) returns http:Response|error {
    log:printInfo("xxx: logger invoked via http end point");

    ctx.inboundProperties.response.setPayload(ctx.payload);
    return ctx.inboundProperties.response;
}

```

- ### Private Flow

**Input (private_flow.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:tracking="http://www.mulesoft.org/schema/mule/ee/tracking" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/tracking http://www.mulesoft.org/schema/mule/ee/tracking/current/mule-tracking-ee.xsd">
    <http:listener-config name="config" host="0.0.0.0" port="8081"  doc:name="HTTP Listener Configuration" basePath="mule3"/>
    <flow name="demoFlow">
        <http:listener config-ref="config" path="/"  doc:name="HTTP" allowedMethods="GET"/>
        <logger message="xxx: logger invoked via http end point" level="INFO" doc:name="Logger"/>
        <flow-ref name="demoPrivateFlow" doc:name="Flow Reference"/>
        <logger message="xxx: end of main flow" level="INFO" doc:name="Logger"/>
    </flow>
    <flow name="demoPrivateFlow">
        <logger message="xxx: private flow invoked" level="INFO" doc:name="Logger"/>
    </flow>
</mule>

```
**Output (private_flow.bal):**
```ballerina
import ballerina/http;
import ballerina/log;

public type InboundProperties record {|
    http:Response response;
    http:Request request;
    map<string> uriParams;
|};

public type Context record {|
    anydata payload;
    InboundProperties inboundProperties;
|};

public listener http:Listener config = new (8081, {host: "0.0.0.0"});

service /mule3 on config {
    Context ctx;

    function init() {
        self.ctx = {payload: (), inboundProperties: {response: new, request: new, uriParams: {}}};
    }

    resource function get .(http:Request request) returns http:Response|error {
        self.ctx.inboundProperties.request = request;
        return _invokeEndPoint0_(self.ctx);
    }
}

public function _invokeEndPoint0_(Context ctx) returns http:Response|error {
    log:printInfo("xxx: logger invoked via http end point");
    demoPrivateFlow(ctx);
    log:printInfo("xxx: end of main flow");

    ctx.inboundProperties.response.setPayload(ctx.payload);
    return ctx.inboundProperties.response;
}

public function demoPrivateFlow(Context ctx) {
    log:printInfo("xxx: private flow invoked");
}

```

## Http Listener

- ### Allowed Resource Default Methods

**Input (allowed_resource_default_methods.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:tracking="http://www.mulesoft.org/schema/mule/ee/tracking" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/tracking http://www.mulesoft.org/schema/mule/ee/tracking/current/mule-tracking-ee.xsd">
    <http:listener-config name="config" host="0.0.0.0" port="8081"  doc:name="HTTP Listener Configuration" basePath="mule3"/>
    <flow name="demoFlow">
        <http:listener config-ref="config" path="/"  doc:name="HTTP"/>
        <logger message="xxx: logger invoked" level="INFO" doc:name="Logger"/>
    </flow>
</mule>

```
**Output (allowed_resource_default_methods.bal):**
```ballerina
import ballerina/http;
import ballerina/log;

public type InboundProperties record {|
    http:Response response;
    http:Request request;
    map<string> uriParams;
|};

public type Context record {|
    anydata payload;
    InboundProperties inboundProperties;
|};

public listener http:Listener config = new (8081, {host: "0.0.0.0"});

service /mule3 on config {
    Context ctx;

    function init() {
        self.ctx = {payload: (), inboundProperties: {response: new, request: new, uriParams: {}}};
    }

    resource function get .(http:Request request) returns http:Response|error {
        self.ctx.inboundProperties.request = request;
        return _invokeEndPoint0_(self.ctx);
    }

    resource function post .(http:Request request) returns http:Response|error {
        self.ctx.inboundProperties.request = request;
        return _invokeEndPoint0_(self.ctx);
    }

    resource function put .(http:Request request) returns http:Response|error {
        self.ctx.inboundProperties.request = request;
        return _invokeEndPoint0_(self.ctx);
    }

    resource function delete .(http:Request request) returns http:Response|error {
        self.ctx.inboundProperties.request = request;
        return _invokeEndPoint0_(self.ctx);
    }

    resource function patch .(http:Request request) returns http:Response|error {
        self.ctx.inboundProperties.request = request;
        return _invokeEndPoint0_(self.ctx);
    }

    resource function head .(http:Request request) returns http:Response|error {
        self.ctx.inboundProperties.request = request;
        return _invokeEndPoint0_(self.ctx);
    }

    resource function options .(http:Request request) returns http:Response|error {
        self.ctx.inboundProperties.request = request;
        return _invokeEndPoint0_(self.ctx);
    }

    resource function trace .(http:Request request) returns http:Response|error {
        self.ctx.inboundProperties.request = request;
        return _invokeEndPoint0_(self.ctx);
    }

    resource function connect .(http:Request request) returns http:Response|error {
        self.ctx.inboundProperties.request = request;
        return _invokeEndPoint0_(self.ctx);
    }
}

public function _invokeEndPoint0_(Context ctx) returns http:Response|error {
    log:printInfo("xxx: logger invoked");

    ctx.inboundProperties.response.setPayload(ctx.payload);
    return ctx.inboundProperties.response;
}

```

- ### Allowed Resource Get Method

**Input (allowed_resource_get_method.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:tracking="http://www.mulesoft.org/schema/mule/ee/tracking" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/tracking http://www.mulesoft.org/schema/mule/ee/tracking/current/mule-tracking-ee.xsd">
    <http:listener-config name="config" host="0.0.0.0" port="8081"  doc:name="HTTP Listener Configuration" basePath="mule3"/>
    <flow name="demoFlow">
        <http:listener config-ref="config" path="/" allowedMethods="POST" doc:name="HTTP"/>
        <logger message="xxx: logger invoked" level="INFO" doc:name="Logger"/>
    </flow>
</mule>

```
**Output (allowed_resource_get_method.bal):**
```ballerina
import ballerina/http;
import ballerina/log;

public type InboundProperties record {|
    http:Response response;
    http:Request request;
    map<string> uriParams;
|};

public type Context record {|
    anydata payload;
    InboundProperties inboundProperties;
|};

public listener http:Listener config = new (8081, {host: "0.0.0.0"});

service /mule3 on config {
    Context ctx;

    function init() {
        self.ctx = {payload: (), inboundProperties: {response: new, request: new, uriParams: {}}};
    }

    resource function post .(http:Request request) returns http:Response|error {
        self.ctx.inboundProperties.request = request;
        return _invokeEndPoint0_(self.ctx);
    }
}

public function _invokeEndPoint0_(Context ctx) returns http:Response|error {
    log:printInfo("xxx: logger invoked");

    ctx.inboundProperties.response.setPayload(ctx.payload);
    return ctx.inboundProperties.response;
}

```

- ### Allowed Resource Multiple Methods

**Input (allowed_resource_multiple_methods.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:tracking="http://www.mulesoft.org/schema/mule/ee/tracking" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/tracking http://www.mulesoft.org/schema/mule/ee/tracking/current/mule-tracking-ee.xsd">
    <http:listener-config name="config" host="0.0.0.0" port="8081"  doc:name="HTTP Listener Configuration" basePath="mule3"/>
    <flow name="demoFlow">
        <http:listener config-ref="config" path="/" allowedMethods="GET, POST, DELETE" doc:name="HTTP"/>
        <logger message="xxx: logger invoked" level="INFO" doc:name="Logger"/>
    </flow>
</mule>

```
**Output (allowed_resource_multiple_methods.bal):**
```ballerina
import ballerina/http;
import ballerina/log;

public type InboundProperties record {|
    http:Response response;
    http:Request request;
    map<string> uriParams;
|};

public type Context record {|
    anydata payload;
    InboundProperties inboundProperties;
|};

public listener http:Listener config = new (8081, {host: "0.0.0.0"});

service /mule3 on config {
    Context ctx;

    function init() {
        self.ctx = {payload: (), inboundProperties: {response: new, request: new, uriParams: {}}};
    }

    resource function get .(http:Request request) returns http:Response|error {
        self.ctx.inboundProperties.request = request;
        return _invokeEndPoint0_(self.ctx);
    }

    resource function post .(http:Request request) returns http:Response|error {
        self.ctx.inboundProperties.request = request;
        return _invokeEndPoint0_(self.ctx);
    }

    resource function delete .(http:Request request) returns http:Response|error {
        self.ctx.inboundProperties.request = request;
        return _invokeEndPoint0_(self.ctx);
    }
}

public function _invokeEndPoint0_(Context ctx) returns http:Response|error {
    log:printInfo("xxx: logger invoked");

    ctx.inboundProperties.response.setPayload(ctx.payload);
    return ctx.inboundProperties.response;
}

```

- ### Basic Http Listener

**Input (basic_http_listener.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd">
    <http:listener-config name="config" host="0.0.0.0" port="8081" basePath="/mule3" doc:name="HTTP Listener Configuration"/>
    <flow name="demoFlow">
        <http:listener config-ref="config" path="/demo" allowedMethods="GET" doc:name="HTTP"/>
        <logger message="xxx: logger invoked" level="INFO" doc:name="Logger"/>
    </flow>
</mule>

```
**Output (basic_http_listener.bal):**
```ballerina
import ballerina/http;
import ballerina/log;

public type InboundProperties record {|
    http:Response response;
    http:Request request;
    map<string> uriParams;
|};

public type Context record {|
    anydata payload;
    InboundProperties inboundProperties;
|};

public listener http:Listener config = new (8081, {host: "0.0.0.0"});

service /mule3 on config {
    Context ctx;

    function init() {
        self.ctx = {payload: (), inboundProperties: {response: new, request: new, uriParams: {}}};
    }

    resource function get demo(http:Request request) returns http:Response|error {
        self.ctx.inboundProperties.request = request;
        return _invokeEndPoint0_(self.ctx);
    }
}

public function _invokeEndPoint0_(Context ctx) returns http:Response|error {
    log:printInfo("xxx: logger invoked");

    ctx.inboundProperties.response.setPayload(ctx.payload);
    return ctx.inboundProperties.response;
}

```

- ### Empty Absolute And Resource Paths

**Input (empty_absolute_and_resource_paths.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd">
    <http:listener-config name="config" host="0.0.0.0" port="8081"  doc:name="HTTP Listener Configuration" />
    <flow name="demoFlow">
        <http:listener config-ref="config" path="/" allowedMethods="GET" doc:name="HTTP"/>
        <logger message="xxx: logger invoked" level="INFO" doc:name="Logger"/>
    </flow>
</mule>

```
**Output (empty_absolute_and_resource_paths.bal):**
```ballerina
import ballerina/http;
import ballerina/log;

public type InboundProperties record {|
    http:Response response;
    http:Request request;
    map<string> uriParams;
|};

public type Context record {|
    anydata payload;
    InboundProperties inboundProperties;
|};

public listener http:Listener config = new (8081, {host: "0.0.0.0"});

service / on config {
    Context ctx;

    function init() {
        self.ctx = {payload: (), inboundProperties: {response: new, request: new, uriParams: {}}};
    }

    resource function get .(http:Request request) returns http:Response|error {
        self.ctx.inboundProperties.request = request;
        return _invokeEndPoint0_(self.ctx);
    }
}

public function _invokeEndPoint0_(Context ctx) returns http:Response|error {
    log:printInfo("xxx: logger invoked");

    ctx.inboundProperties.response.setPayload(ctx.payload);
    return ctx.inboundProperties.response;
}

```

- ### Empty Absolute Path

**Input (empty_absolute_path.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd">
    <http:listener-config name="config" host="0.0.0.0" port="8081"  doc:name="HTTP Listener Configuration"/>
    <flow name="demoFlow">
        <http:listener config-ref="config" path="/demo" allowedMethods="GET" doc:name="HTTP"/>
        <logger message="xxx: logger invoked" level="INFO" doc:name="Logger"/>
    </flow>
</mule>

```
**Output (empty_absolute_path.bal):**
```ballerina
import ballerina/http;
import ballerina/log;

public type InboundProperties record {|
    http:Response response;
    http:Request request;
    map<string> uriParams;
|};

public type Context record {|
    anydata payload;
    InboundProperties inboundProperties;
|};

public listener http:Listener config = new (8081, {host: "0.0.0.0"});

service / on config {
    Context ctx;

    function init() {
        self.ctx = {payload: (), inboundProperties: {response: new, request: new, uriParams: {}}};
    }

    resource function get demo(http:Request request) returns http:Response|error {
        self.ctx.inboundProperties.request = request;
        return _invokeEndPoint0_(self.ctx);
    }
}

public function _invokeEndPoint0_(Context ctx) returns http:Response|error {
    log:printInfo("xxx: logger invoked");

    ctx.inboundProperties.response.setPayload(ctx.payload);
    return ctx.inboundProperties.response;
}

```

- ### Empty Resource Path

**Input (empty_resource_path.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd">
    <http:listener-config name="config" host="0.0.0.0" port="8081"  doc:name="HTTP Listener Configuration" basePath="mule3"/>
    <flow name="demoFlow">
        <http:listener config-ref="config" path="/" allowedMethods="GET" doc:name="HTTP"/>
        <logger message="xxx: logger invoked" level="INFO" doc:name="Logger"/>
    </flow>
</mule>

```
**Output (empty_resource_path.bal):**
```ballerina
import ballerina/http;
import ballerina/log;

public type InboundProperties record {|
    http:Response response;
    http:Request request;
    map<string> uriParams;
|};

public type Context record {|
    anydata payload;
    InboundProperties inboundProperties;
|};

public listener http:Listener config = new (8081, {host: "0.0.0.0"});

service /mule3 on config {
    Context ctx;

    function init() {
        self.ctx = {payload: (), inboundProperties: {response: new, request: new, uriParams: {}}};
    }

    resource function get .(http:Request request) returns http:Response|error {
        self.ctx.inboundProperties.request = request;
        return _invokeEndPoint0_(self.ctx);
    }
}

public function _invokeEndPoint0_(Context ctx) returns http:Response|error {
    log:printInfo("xxx: logger invoked");

    ctx.inboundProperties.response.setPayload(ctx.payload);
    return ctx.inboundProperties.response;
}

```

- ### Resource Path Params

**Input (resource_path_params.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd">
    <http:listener-config name="config" host="0.0.0.0" port="8081"  doc:name="HTTP Listener Configuration" basePath="mule3"/>
    <flow name="demoFlow">
        <http:listener config-ref="config" path="/{version}/demo/{id}/" allowedMethods="GET" doc:name="HTTP"/>
        <logger message="xxx: logger invoked" level="INFO" doc:name="Logger"/>
    </flow>
</mule>

```
**Output (resource_path_params.bal):**
```ballerina
import ballerina/http;
import ballerina/log;

public type InboundProperties record {|
    http:Response response;
    http:Request request;
    map<string> uriParams;
|};

public type Context record {|
    anydata payload;
    InboundProperties inboundProperties;
|};

public listener http:Listener config = new (8081, {host: "0.0.0.0"});

service /mule3 on config {
    Context ctx;

    function init() {
        self.ctx = {payload: (), inboundProperties: {response: new, request: new, uriParams: {}}};
    }

    resource function get [string version]/demo/[string id](http:Request request) returns http:Response|error {
        self.ctx.inboundProperties.uriParams = {version, id};
        self.ctx.inboundProperties.request = request;
        return _invokeEndPoint0_(self.ctx);
    }
}

public function _invokeEndPoint0_(Context ctx) returns http:Response|error {
    log:printInfo("xxx: logger invoked");

    ctx.inboundProperties.response.setPayload(ctx.payload);
    return ctx.inboundProperties.response;
}

```

- ### Special Characters In Resource Path

**Input (special_characters_in_resource_path.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd">
    <http:listener-config name="config" host="0.0.0.0" port="8081"  doc:name="HTTP Listener Configuration" basePath="mule-3"/>
    <flow name="demoFlow">
        <http:listener config-ref="config" path="/v-1/demo/main-contract/" allowedMethods="GET" doc:name="HTTP"/>
        <logger message="xxx: logger invoked" level="INFO" doc:name="Logger"/>
    </flow>
</mule>

```
**Output (special_characters_in_resource_path.bal):**
```ballerina
import ballerina/http;
import ballerina/log;

public type InboundProperties record {|
    http:Response response;
    http:Request request;
    map<string> uriParams;
|};

public type Context record {|
    anydata payload;
    InboundProperties inboundProperties;
|};

public listener http:Listener config = new (8081, {host: "0.0.0.0"});

service /mule\-3 on config {
    Context ctx;

    function init() {
        self.ctx = {payload: (), inboundProperties: {response: new, request: new, uriParams: {}}};
    }

    resource function get v\-1/demo/main\-contract(http:Request request) returns http:Response|error {
        self.ctx.inboundProperties.request = request;
        return _invokeEndPoint0_(self.ctx);
    }
}

public function _invokeEndPoint0_(Context ctx) returns http:Response|error {
    log:printInfo("xxx: logger invoked");

    ctx.inboundProperties.response.setPayload(ctx.payload);
    return ctx.inboundProperties.response;
}

```

## Http Request

- ### Basic Http Request

**Input (basic_http_request.xml):**
```xml
<mule xmlns:jbossts="http://www.mulesoft.org/schema/mule/jbossts" xmlns:vm="http://www.mulesoft.org/schema/mule/vm" xmlns:http="http://www.mulesoft.org/schema/mule/http"
      xmlns:dw="http://www.mulesoft.org/schema/mule/ee/dw"
      xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:spring="http://www.springframework.org/schema/beans" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/dw http://www.mulesoft.org/schema/mule/ee/dw/current/dw.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/vm http://www.mulesoft.org/schema/mule/vm/current/mule-vm.xsd
http://www.mulesoft.org/schema/mule/jbossts http://www.mulesoft.org/schema/mule/jbossts/current/mule-jbossts.xsd">
    <http:request-config name="HTTP_Request_Config" host="jsonplaceholder.typicode.com" port="80" doc:name="HTTP Request Configuration" />
    <flow name="callExternalApiFlow">
        <http:request method="GET"
                      config-ref="HTTP_Request_Config"
                      path="/posts/latest"
                      doc:name="Call External API"/>
        <logger message="Received from external API: #[payload]" level="INFO" />
    </flow>
</mule>

```
**Output (basic_http_request.bal):**
```ballerina
import ballerina/http;
import ballerina/log;

public type Context record {|
    anydata payload;
|};

public function callExternalApiFlow(Context ctx) {

    // http client request
    http:Client HTTP_Request_Config = check new ("jsonplaceholder.typicode.com:80");
    http:Response _clientResult0_ = check HTTP_Request_Config->/posts/latest.get();
    ctx.payload = check _clientResult0_.getJsonPayload();
    log:printInfo(string `Received from external API: ${ctx.payload.toString()}`);
}

```

- ### Http Request Path With Special Characters

**Input (http_request_path_with_special_characters.xml):**
```xml
<mule xmlns:jbossts="http://www.mulesoft.org/schema/mule/jbossts" xmlns:vm="http://www.mulesoft.org/schema/mule/vm" xmlns:http="http://www.mulesoft.org/schema/mule/http"
      xmlns:dw="http://www.mulesoft.org/schema/mule/ee/dw"
      xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:spring="http://www.springframework.org/schema/beans" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/dw http://www.mulesoft.org/schema/mule/ee/dw/current/dw.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/vm http://www.mulesoft.org/schema/mule/vm/current/mule-vm.xsd
http://www.mulesoft.org/schema/mule/jbossts http://www.mulesoft.org/schema/mule/jbossts/current/mule-jbossts.xsd">
    <http:request-config name="HTTP_Request_Config" host="jsonplaceholder.typicode.com" port="80" doc:name="HTTP Request Configuration" />
    <flow name="callExternalApiFlow">
        <http:request method="GET"
                      config-ref="HTTP_Request_Config"
                      path="/car-posts/12/honda-civic/991/latest"
                      doc:name="Call External API"/>
        <logger message="Received from external API: #[payload]" level="INFO" />
    </flow>
</mule>

```
**Output (http_request_path_with_special_characters.bal):**
```ballerina
import ballerina/http;
import ballerina/log;

public type Context record {|
    anydata payload;
|};

public function callExternalApiFlow(Context ctx) {

    // http client request
    http:Client HTTP_Request_Config = check new ("jsonplaceholder.typicode.com:80");
    http:Response _clientResult0_ = check HTTP_Request_Config->/car\-posts/[12]/honda\-civic/[991]/latest.get();
    ctx.payload = check _clientResult0_.getJsonPayload();
    log:printInfo(string `Received from external API: ${ctx.payload.toString()}`);
}

```

- ### Http Request With Http Source

**Input (http_request_with_http_source.xml):**
```xml
<mule xmlns:jbossts="http://www.mulesoft.org/schema/mule/jbossts" xmlns:vm="http://www.mulesoft.org/schema/mule/vm" xmlns:http="http://www.mulesoft.org/schema/mule/http"
      xmlns:dw="http://www.mulesoft.org/schema/mule/ee/dw"
      xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:spring="http://www.springframework.org/schema/beans" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/dw http://www.mulesoft.org/schema/mule/ee/dw/current/dw.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/vm http://www.mulesoft.org/schema/mule/vm/current/mule-vm.xsd
http://www.mulesoft.org/schema/mule/jbossts http://www.mulesoft.org/schema/mule/jbossts/current/mule-jbossts.xsd">
    <http:listener-config name="HTTP_Listener_Config" host="0.0.0.0" port="8081" doc:name="HTTP Listener Configuration" basePath="mule3"/>
    <http:request-config name="HTTP_Request_Config" host="jsonplaceholder.typicode.com" port="80" doc:name="HTTP Request Configuration" />
    <flow name="callExternalApiFlow">
        <http:listener config-ref="HTTP_Listener_Config" path="/"  doc:name="HTTP" allowedMethods="GET"/>
        <http:request method="GET"
                      config-ref="HTTP_Request_Config"
                      path="/posts/latest"
                      doc:name="Call External API"/>
        <logger message="Received from external API: #[payload]" level="INFO" />
    </flow>
</mule>

```
**Output (http_request_with_http_source.bal):**
```ballerina
import ballerina/http;
import ballerina/log;

public type InboundProperties record {|
    http:Response response;
    http:Request request;
    map<string> uriParams;
|};

public type Context record {|
    anydata payload;
    InboundProperties inboundProperties;
|};

public listener http:Listener HTTP_Listener_Config = new (8081, {host: "0.0.0.0"});

service /mule3 on HTTP_Listener_Config {
    Context ctx;

    function init() {
        self.ctx = {payload: (), inboundProperties: {response: new, request: new, uriParams: {}}};
    }

    resource function get .(http:Request request) returns http:Response|error {
        self.ctx.inboundProperties.request = request;
        return _invokeEndPoint0_(self.ctx);
    }
}

public function _invokeEndPoint0_(Context ctx) returns http:Response|error {

    // http client request
    http:Client HTTP_Request_Config = check new ("jsonplaceholder.typicode.com:80");
    http:Response _clientResult0_ = check HTTP_Request_Config->/posts/latest.get();
    ctx.payload = check _clientResult0_.getJsonPayload();
    log:printInfo(string `Received from external API: ${ctx.payload.toString()}`);

    ctx.inboundProperties.response.setPayload(ctx.payload);
    return ctx.inboundProperties.response;
}

```

## Logger

- ### Basic Logger

**Input (basic_logger.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd">
    <http:listener-config name="config" host="0.0.0.0" port="8081"  doc:name="HTTP Listener Configuration" basePath="mule3"/>
    <flow name="demoFlow">
        <http:listener config-ref="config" path="/" allowedMethods="GET" doc:name="HTTP"/>
        <logger message="xxx: first logger invoked" level="INFO" doc:name="Logger"/>
        <logger message="xxx: second logger invoked" level="INFO" doc:name="Logger"/>
    </flow>
</mule>

```
**Output (basic_logger.bal):**
```ballerina
import ballerina/http;
import ballerina/log;

public type InboundProperties record {|
    http:Response response;
    http:Request request;
    map<string> uriParams;
|};

public type Context record {|
    anydata payload;
    InboundProperties inboundProperties;
|};

public listener http:Listener config = new (8081, {host: "0.0.0.0"});

service /mule3 on config {
    Context ctx;

    function init() {
        self.ctx = {payload: (), inboundProperties: {response: new, request: new, uriParams: {}}};
    }

    resource function get .(http:Request request) returns http:Response|error {
        self.ctx.inboundProperties.request = request;
        return _invokeEndPoint0_(self.ctx);
    }
}

public function _invokeEndPoint0_(Context ctx) returns http:Response|error {
    log:printInfo("xxx: first logger invoked");
    log:printInfo("xxx: second logger invoked");

    ctx.inboundProperties.response.setPayload(ctx.payload);
    return ctx.inboundProperties.response;
}

```

- ### Logger Levels

**Input (logger_levels.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:tracking="http://www.mulesoft.org/schema/mule/ee/tracking" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/tracking http://www.mulesoft.org/schema/mule/ee/tracking/current/mule-tracking-ee.xsd">
    <http:listener-config name="config" host="0.0.0.0" port="8081"  doc:name="HTTP Listener Configuration" basePath="mule3"/>
    <flow name="demoFlow">
        <http:listener config-ref="config" path="/" allowedMethods="GET" doc:name="HTTP"/>
        <logger message="xxx: INFO level logger invoked" level="INFO" doc:name="Logger"/>
        <logger message="xxx: DEBUG level logger invoked" level="DEBUG" doc:name="Logger"/>
        <logger message="xxx: ERROR level logger invoked" level="ERROR" doc:name="Logger"/>
        <logger message="xxx: WARN level logger invoked" level="WARN" doc:name="Logger"/>
        <logger message="xxx: TRACE level logger invoked" level="TRACE" doc:name="Logger"/>
    </flow>
</mule>

```
**Output (logger_levels.bal):**
```ballerina
import ballerina/http;
import ballerina/log;

public type InboundProperties record {|
    http:Response response;
    http:Request request;
    map<string> uriParams;
|};

public type Context record {|
    anydata payload;
    InboundProperties inboundProperties;
|};

public listener http:Listener config = new (8081, {host: "0.0.0.0"});

service /mule3 on config {
    Context ctx;

    function init() {
        self.ctx = {payload: (), inboundProperties: {response: new, request: new, uriParams: {}}};
    }

    resource function get .(http:Request request) returns http:Response|error {
        self.ctx.inboundProperties.request = request;
        return _invokeEndPoint0_(self.ctx);
    }
}

public function _invokeEndPoint0_(Context ctx) returns http:Response|error {
    log:printInfo("xxx: INFO level logger invoked");
    log:printDebug("xxx: DEBUG level logger invoked");
    log:printError("xxx: ERROR level logger invoked");
    log:printWarn("xxx: WARN level logger invoked");
    log:printInfo("xxx: TRACE level logger invoked");

    ctx.inboundProperties.response.setPayload(ctx.payload);
    return ctx.inboundProperties.response;
}

```

## Message Enricher

- ### Empty Message Enricher

**Input (empty_message_enricher.xml):**
```xml
<mule xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:spring="http://www.springframework.org/schema/beans" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd">

    <flow name="variableEnricherFlow">
        <set-variable variableName="userId" value="st455u" doc:name="Variable"/>
        <set-variable variableName="enrichedUserId" value="null" doc:name="Variable"/>
        <enricher source="#[flowVars.userId]" target="#[flowVars.enrichedUserId]" doc:name="Message Enricher">
        </enricher>
        <logger message="User ID: #[flowVars.userId], Enriched User ID: #[flowVars.enrichedUserId]" level="INFO" doc:name="Logger"/>
    </flow>

</mule>

```
**Output (empty_message_enricher.bal):**
```ballerina
import ballerina/log;

public type FlowVars record {|
    string userId?;
    string enrichedUserId?;
|};

public type Context record {|
    anydata payload;
    FlowVars flowVars;
|};

public function variableEnricherFlow(Context ctx) {
    ctx.flowVars.userId = "st455u";
    ctx.flowVars.enrichedUserId = "null";
    ctx.flowVars.enrichedUserId = ctx.flowVars.userId;
    log:printInfo(string `User ID: ${ctx.flowVars.userId.toString()}, Enriched User ID: ${ctx.flowVars.enrichedUserId.toString()}`);
}

```

- ### Enricher With Inside Flow Reference

**Input (enricher_with_inside_flow_reference.xml):**
```xml
<mule xmlns:tracking="http://www.mulesoft.org/schema/mule/ee/tracking" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:spring="http://www.springframework.org/schema/beans" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/ee/tracking http://www.mulesoft.org/schema/mule/ee/tracking/current/mule-tracking-ee.xsd">

    <flow name="variableEnricherFlow">
        <set-variable variableName="userId" value="st455u" doc:name="Variable"/>
        <set-variable variableName="enrichedUserId" value="null" doc:name="Variable"/>
        <enricher source="#[flowVars.userId]" target="#[flowVars.enrichedUserId]" doc:name="Message Enricher">
            <flow-ref name="flow1" doc:name="Flow Reference"/>
        </enricher>
        <logger message="User ID: #[flowVars.userId], Enriched User ID: #[flowVars.enrichedUserId]" level="INFO" doc:name="Logger"/>
    </flow>
    <flow name="flow1">
        <logger message="xxx: flow1 starting logger invkoed" level="INFO" doc:name="Logger"/>
        <logger message="xxx: end of flow1 reached" level="INFO" doc:name="Logger"/>
    </flow>

</mule>

```
**Output (enricher_with_inside_flow_reference.bal):**
```ballerina
import ballerina/log;

public type FlowVars record {|
    string userId?;
    string enrichedUserId?;
|};

public type Context record {|
    anydata payload;
    FlowVars flowVars;
|};

public function variableEnricherFlow(Context ctx) {
    ctx.flowVars.userId = "st455u";
    ctx.flowVars.enrichedUserId = "null";
    ctx.flowVars.enrichedUserId = _enricher0_(ctx.clone());
    log:printInfo(string `User ID: ${ctx.flowVars.userId.toString()}, Enriched User ID: ${ctx.flowVars.enrichedUserId.toString()}`);
}

public function _enricher0_(Context ctx) returns string? {
    flow1(ctx);
    return ctx.flowVars.userId;
}

public function flow1(Context ctx) {
    log:printInfo("xxx: flow1 starting logger invkoed");
    log:printInfo("xxx: end of flow1 reached");
}

```

- ### Enricher With Inside Logger

**Input (enricher_with_inside_logger.xml):**
```xml
<mule xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:spring="http://www.springframework.org/schema/beans" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd">

    <flow name="variableEnricherFlow">
        <set-variable variableName="userId" value="st455u" doc:name="Variable"/>
        <set-variable variableName="enrichedUserId" value="null" doc:name="Variable"/>
        <enricher source="#[flowVars.userId]" target="#[flowVars.enrichedUserId]" doc:name="Message Enricher">
            <logger message="xxx: logger inside the message enricher invoked" level="INFO" doc:name="Logger"/>
        </enricher>
        <logger message="User ID: #[flowVars.userId], Enriched User ID: #[flowVars.enrichedUserId]" level="INFO" doc:name="Logger"/>
    </flow>

</mule>

```
**Output (enricher_with_inside_logger.bal):**
```ballerina
import ballerina/log;

public type FlowVars record {|
    string userId?;
    string enrichedUserId?;
|};

public type Context record {|
    anydata payload;
    FlowVars flowVars;
|};

public function _enricher0_(Context ctx) returns string? {
    log:printInfo("xxx: logger inside the message enricher invoked");
    return ctx.flowVars.userId;
}

public function variableEnricherFlow(Context ctx) {
    ctx.flowVars.userId = "st455u";
    ctx.flowVars.enrichedUserId = "null";
    ctx.flowVars.enrichedUserId = _enricher0_(ctx.clone());
    log:printInfo(string `User ID: ${ctx.flowVars.userId.toString()}, Enriched User ID: ${ctx.flowVars.enrichedUserId.toString()}`);
}

```

## Object To Json

- ### Basic Object To Json

**Input (basic_object_to_json.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:db="http://www.mulesoft.org/schema/mule/db" xmlns:json="http://www.mulesoft.org/schema/mule/json" xmlns:tracking="http://www.mulesoft.org/schema/mule/ee/tracking" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/tracking http://www.mulesoft.org/schema/mule/ee/tracking/current/mule-tracking-ee.xsd
http://www.mulesoft.org/schema/mule/db http://www.mulesoft.org/schema/mule/db/current/mule-db.xsd
http://www.mulesoft.org/schema/mule/json http://www.mulesoft.org/schema/mule/json/current/mule-json.xsd">
    <http:listener-config name="config" host="0.0.0.0" port="8081"  doc:name="HTTP Listener Configuration" basePath="mule3"/>
    <db:mysql-config name="MySQL_Configuration" host="localhost" port="3306" user="root" password="admin123" database="test_db" doc:name="MySQL Configuration"/>
    <flow name="demoFlow">
        <http:listener config-ref="config" path="/" allowedMethods="GET" doc:name="HTTP"/>
        <db:select config-ref="MySQL_Configuration" doc:name="Database">
            <db:parameterized-query><![CDATA[SELECT * FROM users;]]></db:parameterized-query>
        </db:select>
        <json:object-to-json-transformer doc:name="Object to JSON"/>
    </flow>
</mule>

```
**Output (basic_object_to_json.bal):**
```ballerina
import ballerina/http;
import ballerina/sql;
import ballerinax/mysql;
import ballerinax/mysql.driver as _;

public type InboundProperties record {|
    http:Response response;
    http:Request request;
    map<string> uriParams;
|};

public type Context record {|
    anydata payload;
    InboundProperties inboundProperties;
|};

public type Record record {
};

mysql:Client MySQL_Configuration = check new ("localhost", "root", "admin123", "test_db", 3306);
public listener http:Listener config = new (8081, {host: "0.0.0.0"});

service /mule3 on config {
    Context ctx;

    function init() {
        self.ctx = {payload: (), inboundProperties: {response: new, request: new, uriParams: {}}};
    }

    resource function get .(http:Request request) returns http:Response|error {
        self.ctx.inboundProperties.request = request;
        return _invokeEndPoint0_(self.ctx);
    }
}

public function _invokeEndPoint0_(Context ctx) returns http:Response|error {

    // database operation
    sql:ParameterizedQuery _dbQuery0_ = `SELECT * FROM users;`;
    stream<Record, sql:Error?> _dbStream0_ = MySQL_Configuration->query(_dbQuery0_);
    Record[] _dbSelect0_ = check from Record _iterator_ in _dbStream0_
        select _iterator_;
    ctx.payload = _dbSelect0_;

    // json transformation
    json _to_json0_ = _dbSelect0_.toJson();
    ctx.payload = _to_json0_;

    ctx.inboundProperties.response.setPayload(ctx.payload);
    return ctx.inboundProperties.response;
}

```

## Object To String

- ### Basic Object To String

**Input (basic_object_to_string.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:db="http://www.mulesoft.org/schema/mule/db" xmlns:json="http://www.mulesoft.org/schema/mule/json" xmlns:tracking="http://www.mulesoft.org/schema/mule/ee/tracking" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/tracking http://www.mulesoft.org/schema/mule/ee/tracking/current/mule-tracking-ee.xsd
http://www.mulesoft.org/schema/mule/db http://www.mulesoft.org/schema/mule/db/current/mule-db.xsd
http://www.mulesoft.org/schema/mule/json http://www.mulesoft.org/schema/mule/json/current/mule-json.xsd">
    <http:listener-config name="config" host="0.0.0.0" port="8081"  doc:name="HTTP Listener Configuration" basePath="mule3"/>
    <db:mysql-config name="MySQL_Configuration" host="localhost" port="3306" user="root" password="admin123" database="test_db" doc:name="MySQL Configuration"/>
    <flow name="demoFlow">
        <http:listener config-ref="config" path="/" allowedMethods="GET" doc:name="HTTP"/>
        <db:select config-ref="MySQL_Configuration" doc:name="Database">
            <db:parameterized-query><![CDATA[SELECT * FROM users;]]></db:parameterized-query>
        </db:select>
        <object-to-string-transformer doc:name="Object to String"/>
    </flow>
</mule>

```
**Output (basic_object_to_string.bal):**
```ballerina
import ballerina/http;
import ballerina/sql;
import ballerinax/mysql;
import ballerinax/mysql.driver as _;

public type InboundProperties record {|
    http:Response response;
    http:Request request;
    map<string> uriParams;
|};

public type Context record {|
    anydata payload;
    InboundProperties inboundProperties;
|};

public type Record record {
};

mysql:Client MySQL_Configuration = check new ("localhost", "root", "admin123", "test_db", 3306);
public listener http:Listener config = new (8081, {host: "0.0.0.0"});

service /mule3 on config {
    Context ctx;

    function init() {
        self.ctx = {payload: (), inboundProperties: {response: new, request: new, uriParams: {}}};
    }

    resource function get .(http:Request request) returns http:Response|error {
        self.ctx.inboundProperties.request = request;
        return _invokeEndPoint0_(self.ctx);
    }
}

public function _invokeEndPoint0_(Context ctx) returns http:Response|error {

    // database operation
    sql:ParameterizedQuery _dbQuery0_ = `SELECT * FROM users;`;
    stream<Record, sql:Error?> _dbStream0_ = MySQL_Configuration->query(_dbQuery0_);
    Record[] _dbSelect0_ = check from Record _iterator_ in _dbStream0_
        select _iterator_;
    ctx.payload = _dbSelect0_;

    // string transformation
    string _to_string0_ = _dbSelect0_.toString();
    ctx.payload = _to_string0_;

    ctx.inboundProperties.response.setPayload(ctx.payload);
    return ctx.inboundProperties.response;
}

```

## Reference Exception Strategy

- ### Basic Reference Exception Strategy

**Input (basic_reference_exception_strategy.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:tracking="http://www.mulesoft.org/schema/mule/ee/tracking" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/tracking http://www.mulesoft.org/schema/mule/ee/tracking/current/mule-tracking-ee.xsd">
    <catch-exception-strategy name="catch-exception-strategy">
        <logger level="INFO" doc:name="Logger" message="xxx: inside catch exception strategy"/>
    </catch-exception-strategy>
    <flow name="muleProject">
        <logger level="INFO" doc:name="Logger" message="xxx: end of flow reached"/>
        <exception-strategy ref="catch-exception-strategy" doc:name="Reference Exception Strategy"/>
    </flow>
</mule>

```
**Output (basic_reference_exception_strategy.bal):**
```ballerina
import ballerina/log;

public type Context record {|
    anydata payload;
|};

public function muleProject(Context ctx) {
    do {
        log:printInfo("xxx: end of flow reached");
    } on fail error e {
        catch\-exception\-strategy(ctx, e);
    }
}

public function catch\-exception\-strategy(Context ctx, error e) {
    log:printInfo("xxx: inside catch exception strategy");
}

```

- ### Reference Exception With Http Listener Source

**Input (reference_exception_with_http_listener_source.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:tracking="http://www.mulesoft.org/schema/mule/ee/tracking" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/tracking http://www.mulesoft.org/schema/mule/ee/tracking/current/mule-tracking-ee.xsd">
    <http:listener-config name="httpConfig" host="0.0.0.0" port="8081" basePath="/" doc:name="HTTP Listener Configuration"/>
    <catch-exception-strategy name="catch-exception-strategy">
        <logger level="INFO" doc:name="Logger" message="xxx: inside catch exception strategy"/>
    </catch-exception-strategy>
    <flow name="muleProject">
        <http:listener config-ref="httpConfig" path="/" doc:name="HTTP" allowedMethods="GET"/>
        <logger level="INFO" doc:name="Logger" message="xxx: end of flow reached"/>
        <exception-strategy ref="catch-exception-strategy" doc:name="Reference Exception Strategy"/>
    </flow>
</mule>

```
**Output (reference_exception_with_http_listener_source.bal):**
```ballerina
import ballerina/http;
import ballerina/log;

public type InboundProperties record {|
    http:Response response;
    http:Request request;
    map<string> uriParams;
|};

public type Context record {|
    anydata payload;
    InboundProperties inboundProperties;
|};

public listener http:Listener httpConfig = new (8081, {host: "0.0.0.0"});

service / on httpConfig {
    Context ctx;

    function init() {
        self.ctx = {payload: (), inboundProperties: {response: new, request: new, uriParams: {}}};
    }

    resource function get .(http:Request request) returns http:Response|error {
        self.ctx.inboundProperties.request = request;
        return _invokeEndPoint0_(self.ctx);
    }
}

public function _invokeEndPoint0_(Context ctx) returns http:Response|error {
    do {
        log:printInfo("xxx: end of flow reached");
    } on fail error e {
        catch\-exception\-strategy(ctx, e);
    }

    ctx.inboundProperties.response.setPayload(ctx.payload);
    return ctx.inboundProperties.response;
}

public function catch\-exception\-strategy(Context ctx, error e) {
    log:printInfo("xxx: inside catch exception strategy");
}

```

## Session Variable

- ### Basic Set Session Variable

**Input (basic_set_session_variable.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:spring="http://www.springframework.org/schema/beans" xmlns:http="http://www.mulesoft.org/schema/mule/http"
      xmlns="http://www.mulesoft.org/schema/mule/core"
      xmlns:json="http://www.mulesoft.org/schema/mule/json"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/json http://www.mulesoft.org/schema/mule/json/current/mule-json.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd">
    <flow name="myFlow">
        <logger message="xxx: flow starting logger invoked" level="INFO" doc:name="Logger"/>
        <set-session-variable variableName="sessionVar1" value="this is first session variable" doc:name="Session Variable"/>
        <set-session-variable variableName="sessionVar2" value="this is second session variable" doc:name="Session Variable"/>
        <logger message="xxx: end of flow reached" level="INFO" doc:name="Logger"/>
    </flow>
</mule>

```
**Output (basic_set_session_variable.bal):**
```ballerina
import ballerina/log;

public type SessionVars record {|
    string sessionVar1?;
    string sessionVar2?;
|};

public type Context record {|
    anydata payload;
    SessionVars sessionVars;
|};

public function myFlow(Context ctx) {
    log:printInfo("xxx: flow starting logger invoked");
    ctx.sessionVars.sessionVar1 = "this is first session variable";
    ctx.sessionVars.sessionVar2 = "this is second session variable";
    log:printInfo("xxx: end of flow reached");
}

```

- ### Set Session Variable With Http Source

**Input (set_session_variable_with_http_source.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:spring="http://www.springframework.org/schema/beans" xmlns:http="http://www.mulesoft.org/schema/mule/http"
      xmlns="http://www.mulesoft.org/schema/mule/core"
      xmlns:json="http://www.mulesoft.org/schema/mule/json"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/json http://www.mulesoft.org/schema/mule/json/current/mule-json.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd">
    <http:listener-config name="HTTP_Config" host="0.0.0.0" port="8081" basePath="/mule3" doc:name="HTTP Listener Config"/>
    <flow name="sessionVarExampleFlow">
        <!-- HTTP Listener as the source -->
        <http:listener config-ref="HTTP_Config" path="/session" allowedMethods="GET" doc:name="HTTP Listener"/>

        <!-- Set Session Variable -->
        <set-session-variable variableName="sessionVarExample" value="Initial Value" doc:name="Set Session Variable"/>

        <!-- Log Initial Session Variable -->
        <logger message="Session Variable (Initial): #[sessionVars.sessionVarExample]" level="INFO" doc:name="Logger Initial"/>

        <!-- Modify Session Variable -->
        <set-session-variable variableName="sessionVarExample" value="Modified Value" doc:name="Modify Session Variable"/>

        <!-- Log Modified Session Variable -->
        <logger message="Session Variable (Modified): #[sessionVars.sessionVarExample]" level="INFO" doc:name="Logger Modified"/>

        <set-payload value="{&quot;message&quot;:&quot;Check logs for session variable values&quot;}" doc:name="Set JSON Response"/>
    </flow>
</mule>

```
**Output (set_session_variable_with_http_source.bal):**
```ballerina
import ballerina/http;
import ballerina/log;

public type SessionVars record {|
    string sessionVarExample?;
|};

public type InboundProperties record {|
    http:Response response;
    http:Request request;
    map<string> uriParams;
|};

public type Context record {|
    anydata payload;
    SessionVars sessionVars;
    InboundProperties inboundProperties;
|};

public listener http:Listener HTTP_Config = new (8081, {host: "0.0.0.0"});

service /mule3 on HTTP_Config {
    Context ctx;

    function init() {
        self.ctx = {payload: (), sessionVars: {}, inboundProperties: {response: new, request: new, uriParams: {}}};
    }

    resource function get session(http:Request request) returns http:Response|error {
        self.ctx.inboundProperties.request = request;
        return _invokeEndPoint0_(self.ctx);
    }
}

public function _invokeEndPoint0_(Context ctx) returns http:Response|error {
    ctx.sessionVars.sessionVarExample = "Initial Value";
    log:printInfo(string `Session Variable (Initial): ${ctx.sessionVars.sessionVarExample.toString()}`);
    ctx.sessionVars.sessionVarExample = "Modified Value";
    log:printInfo(string `Session Variable (Modified): ${ctx.sessionVars.sessionVarExample.toString()}`);

    // set payload
    string _payload0_ = "{\"message\":\"Check logs for session variable values\"}";
    ctx.payload = _payload0_;

    ctx.inboundProperties.response.setPayload(ctx.payload);
    return ctx.inboundProperties.response;
}

```

- ### Updating Same Session Variable

**Input (updating_same_session_variable.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:spring="http://www.springframework.org/schema/beans" xmlns:http="http://www.mulesoft.org/schema/mule/http"
      xmlns="http://www.mulesoft.org/schema/mule/core"
      xmlns:json="http://www.mulesoft.org/schema/mule/json"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/json http://www.mulesoft.org/schema/mule/json/current/mule-json.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd">
    <flow name="myFlow">
        <logger message="xxx: flow starting logger invoked" level="INFO" doc:name="Logger"/>
        <set-session-variable variableName="sessionVar1" value="initial value" doc:name="Session Variable"/>
        <set-session-variable variableName="sessionVar1" value="updated value" doc:name="Session Variable"/>
        <logger message="xxx: end of flow reached" level="INFO" doc:name="Logger"/>
    </flow>
</mule>

```
**Output (updating_same_session_variable.bal):**
```ballerina
import ballerina/log;

public type SessionVars record {|
    string sessionVar1?;
|};

public type Context record {|
    anydata payload;
    SessionVars sessionVars;
|};

public function myFlow(Context ctx) {
    log:printInfo("xxx: flow starting logger invoked");
    ctx.sessionVars.sessionVar1 = "initial value";
    ctx.sessionVars.sessionVar1 = "updated value";
    log:printInfo("xxx: end of flow reached");
}

```

## Set Payload

- ### Basic Set Payload

**Input (basic_set_payload.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:tracking="http://www.mulesoft.org/schema/mule/ee/tracking" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/tracking http://www.mulesoft.org/schema/mule/ee/tracking/current/mule-tracking-ee.xsd">
    <http:listener-config name="config" host="0.0.0.0" port="8081"  doc:name="HTTP Listener Configuration" basePath="mule3"/>
    <flow name="demoFlow">
        <http:listener config-ref="config" path="/" allowedMethods="GET" doc:name="HTTP"/>
        <set-payload value="Hello world!" doc:name="Set Payload"/>
    </flow>
</mule>

```
**Output (basic_set_payload.bal):**
```ballerina
import ballerina/http;

public type InboundProperties record {|
    http:Response response;
    http:Request request;
    map<string> uriParams;
|};

public type Context record {|
    anydata payload;
    InboundProperties inboundProperties;
|};

public listener http:Listener config = new (8081, {host: "0.0.0.0"});

service /mule3 on config {
    Context ctx;

    function init() {
        self.ctx = {payload: (), inboundProperties: {response: new, request: new, uriParams: {}}};
    }

    resource function get .(http:Request request) returns http:Response|error {
        self.ctx.inboundProperties.request = request;
        return _invokeEndPoint0_(self.ctx);
    }
}

public function _invokeEndPoint0_(Context ctx) returns http:Response|error {

    // set payload
    string _payload0_ = "Hello world!";
    ctx.payload = _payload0_;

    ctx.inboundProperties.response.setPayload(ctx.payload);
    return ctx.inboundProperties.response;
}

```

- ### Multiple Set Payloads

**Input (multiple_set_payloads.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:tracking="http://www.mulesoft.org/schema/mule/ee/tracking" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/tracking http://www.mulesoft.org/schema/mule/ee/tracking/current/mule-tracking-ee.xsd">
    <http:listener-config name="config" host="0.0.0.0" port="8081"  doc:name="HTTP Listener Configuration" basePath="mule3"/>
    <flow name="demoFlow">
        <http:listener config-ref="config" path="/" allowedMethods="GET" doc:name="HTTP"/>
        <set-payload value="First payload" doc:name="Set Payload"/>
        <set-payload value="Second payload" doc:name="Set Payload"/>
        <set-payload value="Third payload" doc:name="Set Payload"/>
    </flow>
</mule>

```
**Output (multiple_set_payloads.bal):**
```ballerina
import ballerina/http;

public type InboundProperties record {|
    http:Response response;
    http:Request request;
    map<string> uriParams;
|};

public type Context record {|
    anydata payload;
    InboundProperties inboundProperties;
|};

public listener http:Listener config = new (8081, {host: "0.0.0.0"});

service /mule3 on config {
    Context ctx;

    function init() {
        self.ctx = {payload: (), inboundProperties: {response: new, request: new, uriParams: {}}};
    }

    resource function get .(http:Request request) returns http:Response|error {
        self.ctx.inboundProperties.request = request;
        return _invokeEndPoint0_(self.ctx);
    }
}

public function _invokeEndPoint0_(Context ctx) returns http:Response|error {

    // set payload
    string _payload0_ = "First payload";
    ctx.payload = _payload0_;

    // set payload
    string _payload1_ = "Second payload";
    ctx.payload = _payload1_;

    // set payload
    string _payload2_ = "Third payload";
    ctx.payload = _payload2_;

    ctx.inboundProperties.response.setPayload(ctx.payload);
    return ctx.inboundProperties.response;
}

```

## Sub Flow

- ### Basic Sub Flow

**Input (basic_sub_flow.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:tracking="http://www.mulesoft.org/schema/mule/ee/tracking" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/tracking http://www.mulesoft.org/schema/mule/ee/tracking/current/mule-tracking-ee.xsd">
    <http:listener-config name="config" host="0.0.0.0" port="8081"  doc:name="HTTP Listener Configuration" basePath="mule3"/>
    <flow name="demoFlow">
        <http:listener config-ref="config" path="/"  doc:name="HTTP" allowedMethods="GET"/>
        <logger message="xxx: logger invoked via http end point" level="INFO" doc:name="Logger"/>
        <flow-ref name="demoSub_Flow" doc:name="Flow Reference"/>
        <logger message="xxx: logger after flow reference invoked" level="INFO" doc:name="Logger"/>
    </flow>
    <sub-flow name="demoSub_Flow">
        <logger message="xxx: sub flow logger invoked" level="INFO" doc:name="Logger"/>
        <set-payload value="This is a sub flow set-payload call" doc:name="Set Payload"/>
    </sub-flow>
</mule>

```
**Output (basic_sub_flow.bal):**
```ballerina
import ballerina/http;
import ballerina/log;

public type InboundProperties record {|
    http:Response response;
    http:Request request;
    map<string> uriParams;
|};

public type Context record {|
    anydata payload;
    InboundProperties inboundProperties;
|};

public listener http:Listener config = new (8081, {host: "0.0.0.0"});

service /mule3 on config {
    Context ctx;

    function init() {
        self.ctx = {payload: (), inboundProperties: {response: new, request: new, uriParams: {}}};
    }

    resource function get .(http:Request request) returns http:Response|error {
        self.ctx.inboundProperties.request = request;
        return _invokeEndPoint0_(self.ctx);
    }
}

public function _invokeEndPoint0_(Context ctx) returns http:Response|error {
    log:printInfo("xxx: logger invoked via http end point");
    demoSub_Flow(ctx);
    log:printInfo("xxx: logger after flow reference invoked");

    ctx.inboundProperties.response.setPayload(ctx.payload);
    return ctx.inboundProperties.response;
}

public function demoSub_Flow(Context ctx) {
    log:printInfo("xxx: sub flow logger invoked");

    // set payload
    string _payload0_ = "This is a sub flow set-payload call";
    ctx.payload = _payload0_;
}

```

## Transform Message

See [DataWeave Samples](Dataweave_samples.md) for more details on Dataweave conversions.

- ### Transform Message With Components

**Input (transform_message_with_components.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:dw="http://www.mulesoft.org/schema/mule/ee/dw" xmlns:metadata="http://www.mulesoft.org/schema/mule/metadata" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/dw http://www.mulesoft.org/schema/mule/ee/dw/current/dw.xsd">
    <http:listener-config name="config" host="0.0.0.0" port="8081" basePath="/foo" doc:name="HTTP Listener Configuration"/>
    <flow name="mule6demoFlow">
        <http:listener config-ref="config" path="/" allowedMethods="GET" doc:name="HTTP"/>
        <dw:transform-message>
            <dw:input-payload mimeType="application/json"/>
            <dw:set-variable variableName="myVariable"
                             resource="blocks/mule3/transform-message/dataweave-files/transform_message_with_components.dwl"/>
            <dw:set-payload resource="blocks/mule3/transform-message/dataweave-files/transform_message_with_components.dwl"/>
            <dw:set-session-variable variableName="mySessionVariable"
                      resource="blocks/mule3/transform-message/dataweave-files/transform_message_with_components.dwl"/>
        </dw:transform-message>
    </flow>
</mule>

```
**Output (transform_message_with_components.bal):**
```ballerina
import ballerina/http;

public type InboundProperties record {|
    http:Response response;
    http:Request request;
    map<string> uriParams;
|};

public type Context record {|
    anydata payload;
    InboundProperties inboundProperties;
|};

public listener http:Listener config = new (8081, {host: "0.0.0.0"});

service /foo on config {
    Context ctx;

    function init() {
        self.ctx = {payload: (), inboundProperties: {response: new, request: new, uriParams: {}}};
    }

    resource function get .(http:Request request) returns http:Response|error {
        self.ctx.inboundProperties.request = request;
        return _invokeEndPoint0_(self.ctx);
    }
}

public function _invokeEndPoint0_(Context ctx) returns http:Response|error {
    json myVariable = _dwMethod0_(ctx.payload.toJson());
    json _dwOutput_ = _dwMethod0_(ctx.payload.toJson());
    json mySessionVariable = _dwMethod0_(ctx.payload.toJson());
    ctx.payload = _dwOutput_;

    ctx.inboundProperties.response.setPayload(ctx.payload);
    return ctx.inboundProperties.response;
}

function _dwMethod0_(json payload) returns json {
    return "apple".toUpperAscii();
}

```

- ### Transform Message With Simple Value

**Input (transform_message_with_simple_value.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:dw="http://www.mulesoft.org/schema/mule/ee/dw" xmlns:metadata="http://www.mulesoft.org/schema/mule/metadata" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/dw http://www.mulesoft.org/schema/mule/ee/dw/current/dw.xsd">
    <http:listener-config name="config" host="0.0.0.0" port="8081" basePath="/foo" doc:name="HTTP Listener Configuration"/>
    <flow name="mule6demoFlow">
        <http:listener config-ref="config" path="/" allowedMethods="GET" doc:name="HTTP"/>
        <dw:transform-message doc:name="Transform Message" metadata:id="7ac8bde9-bc67-492b-b681-45be71ec7e83">
            <dw:input-payload mimeType="application/java"/>
            <dw:set-payload><![CDATA[%dw 1.0
%output application/json
%input payload application/json
%var conversionRate=13.15
---
{s1: "Hello World", s2: 'Hello World', n: 1.23, b: true, a:[1,2,3], o:{ name:  "Anne" }}]]></dw:set-payload>
        </dw:transform-message>
    </flow>
</mule>

```
**Output (transform_message_with_simple_value.bal):**
```ballerina
import ballerina/http;

public type InboundProperties record {|
    http:Response response;
    http:Request request;
    map<string> uriParams;
|};

public type Context record {|
    anydata payload;
    InboundProperties inboundProperties;
|};

public listener http:Listener config = new (8081, {host: "0.0.0.0"});

service /foo on config {
    Context ctx;

    function init() {
        self.ctx = {payload: (), inboundProperties: {response: new, request: new, uriParams: {}}};
    }

    resource function get .(http:Request request) returns http:Response|error {
        self.ctx.inboundProperties.request = request;
        return _invokeEndPoint0_(self.ctx);
    }
}

function _dwMethod0_(json payload) returns json|error {
    float conversionRate = 13.15;
    return {"s1": "Hello World", "s2": "Hello World", "n": 1.23, "b": true, "a": check [1, 2, 3].ensureType(json), "o": check {"name": "Anne"}.ensureType(json)};
}

public function _invokeEndPoint0_(Context ctx) returns http:Response|error {
    json _dwOutput_ = check _dwMethod0_(ctx.payload.toJson());
    ctx.payload = _dwOutput_;

    ctx.inboundProperties.response.setPayload(ctx.payload);
    return ctx.inboundProperties.response;
}

```

- ### Transform Message With Unsupported Components

**Input (transform_message_with_unsupported_components.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:dw="http://www.mulesoft.org/schema/mule/ee/dw" xmlns:metadata="http://www.mulesoft.org/schema/mule/metadata"
      xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core"
      xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/dw http://www.mulesoft.org/schema/mule/ee/dw/current/dw.xsd">
    <flow name="sampleFlow">
        <dw:transform-message>
            <dw:input-payload mimeType="application/json"/>
            <dw:set-payload><![CDATA[%dw 1.0
%dw 1.0
%output application/json
%input payload application/json
%var conversionRate=13.15
---
[1, 2, 3, 4] map ,
]]></dw:set-payload>
            <dw:set-payload><![CDATA[%dw 1.0
%output application/json
%input payload application/xml
---
[1, 2, 3, 4] map $ + 1]]></dw:set-payload>
            <dw:set-payload><![CDATA[%dw 1.0
%output application/json
%input payload application/json
---
payload groupBy $.language
]]></dw:set-payload>
        </dw:transform-message>
    </flow>
</mule>

```
**Output (transform_message_with_unsupported_components.bal):**
```ballerina
public type Context record {|
    anydata payload;
|};

function _dwMethod1_(xml payload) returns json {
    //TODO: UNSUPPORTED DATAWEAVE EXPRESSION 'map$+1' OF TYPE 'xml' FOUND. MANUAL CONVERSION REQUIRED.
}

function _dwMethod2_(json payload) returns json {
    //TODO: UNSUPPORTED DATAWEAVE EXPRESSION 'groupBy$.language' FOUND. MANUAL CONVERSION REQUIRED.
}

public function sampleFlow(Context ctx) {
    json _dwOutput_ = _dwMethod0_(ctx.payload.toJson());
    _dwOutput_ = _dwMethod1_(ctx.payload.toJson());
    _dwOutput_ = _dwMethod2_(ctx.payload.toJson());
    ctx.payload = _dwOutput_;
}

function _dwMethod0_(json payload) returns json {
    float conversionRate = 13.15;
    return [1, 2, 3, 4];
    // DATAWEAVE PARSING FAILED.
    // line 7:13 mismatched input 'map' expecting {<EOF>, NEWLINE}

}

```

## Variable

- ### Basic Set Variable

**Input (basic_set_variable.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:tracking="http://www.mulesoft.org/schema/mule/ee/tracking" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/tracking http://www.mulesoft.org/schema/mule/ee/tracking/current/mule-tracking-ee.xsd">
    <http:listener-config name="config" host="0.0.0.0" port="8081"  doc:name="HTTP Listener Configuration" basePath="mule3"/>
    <flow name="demoFlow">
        <http:listener config-ref="config" path="/" allowedMethods="GET" doc:name="HTTP"/>
        <set-variable variableName="name" value="lochana" doc:name="Variable"/>
        <set-variable variableName="age" value="29" doc:name="Variable"/>
    </flow>
</mule>

```
**Output (basic_set_variable.bal):**
```ballerina
import ballerina/http;

public type FlowVars record {|
    string name?;
    string age?;
|};

public type InboundProperties record {|
    http:Response response;
    http:Request request;
    map<string> uriParams;
|};

public type Context record {|
    anydata payload;
    FlowVars flowVars;
    InboundProperties inboundProperties;
|};

public listener http:Listener config = new (8081, {host: "0.0.0.0"});

service /mule3 on config {
    Context ctx;

    function init() {
        self.ctx = {payload: (), flowVars: {}, inboundProperties: {response: new, request: new, uriParams: {}}};
    }

    resource function get .(http:Request request) returns http:Response|error {
        self.ctx.inboundProperties.request = request;
        return _invokeEndPoint0_(self.ctx);
    }
}

public function _invokeEndPoint0_(Context ctx) returns http:Response|error {
    ctx.flowVars.name = "lochana";
    ctx.flowVars.age = "29";

    ctx.inboundProperties.response.setPayload(ctx.payload);
    return ctx.inboundProperties.response;
}

```

## Vm Connector

- ### Simple Vm Connector

**Input (simple_vm_connector.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:tracking="http://www.mulesoft.org/schema/mule/ee/tracking" xmlns:vm="http://www.mulesoft.org/schema/mule/vm" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/vm http://www.mulesoft.org/schema/mule/vm/current/mule-vm.xsd
http://www.mulesoft.org/schema/mule/ee/tracking http://www.mulesoft.org/schema/mule/ee/tracking/current/mule-tracking-ee.xsd">
    <flow name="outboundVmFlow">
        <set-payload value="#['Hello World']" doc:name="Set Payload"/>
        <vm:outbound-endpoint exchange-pattern="one-way" path="path-xxx" doc:name="VM"/>
    </flow>
    <flow name="inboundVmFlow">
        <vm:inbound-endpoint exchange-pattern="one-way"  doc:name="VM" path="path-xxx"/>
        <logger message="Received a message: #[payload]" level="INFO" doc:name="Logger"/>
    </flow>
</mule>

```
**Output (simple_vm_connector.bal):**
```ballerina
import ballerina/log;

public type Context record {|
    anydata payload;
|};

public function inboundVmFlow(Context ctx) {
    log:printInfo(string `Received a message: ${ctx.payload.toString()}`);
}

public function outboundVmFlow(Context ctx) {
    worker W returns error? {
        // VM Inbound Endpoint
        anydata receivedPayload = <- function;
        ctx.payload = receivedPayload;
        inboundVmFlow(ctx);
    }

    // set payload
    string _payload0_ = "Hello World";
    ctx.payload = _payload0_;

    // VM Outbound Endpoint
    ctx.payload -> W;
}

```

- ### Vm Connector Inside Async Block

**Input (vm_connector_inside_async_block.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns:tracking="http://www.mulesoft.org/schema/mule/ee/tracking" xmlns:vm="http://www.mulesoft.org/schema/mule/vm" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/vm http://www.mulesoft.org/schema/mule/vm/current/mule-vm.xsd
http://www.mulesoft.org/schema/mule/ee/tracking http://www.mulesoft.org/schema/mule/ee/tracking/current/mule-tracking-ee.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd">
    <http:listener-config name="HTTP_Listener_Configuration" host="0.0.0.0" port="8081" basePath="/" doc:name="HTTP Listener Configuration"/>
    <flow name="outboundVmFlow">
        <http:listener config-ref="HTTP_Listener_Configuration" path="/vm" allowedMethods="GET" doc:name="HTTP"/>
        <set-payload value="#['Hello World']" doc:name="Set Payload"/>
        <async doc:name="Async">
            <vm:outbound-endpoint exchange-pattern="one-way" path="path-xxx" doc:name="VM"/>
        </async>
        <logger message="xxx: logger after async block invoked" level="INFO" doc:name="Logger"/>
    </flow>
    <flow name="inboundVmFow">
        <vm:inbound-endpoint exchange-pattern="one-way"  doc:name="VM" path="path-xxx"/>
        <logger message="Received a message: #[payload]" level="INFO" doc:name="Logger"/>
    </flow>
</mule>

```
**Output (vm_connector_inside_async_block.bal):**
```ballerina
import ballerina/http;
import ballerina/log;

public type InboundProperties record {|
    http:Response response;
    http:Request request;
    map<string> uriParams;
|};

public type Context record {|
    anydata payload;
    InboundProperties inboundProperties;
|};

public listener http:Listener HTTP_Listener_Configuration = new (8081, {host: "0.0.0.0"});

service / on HTTP_Listener_Configuration {
    Context ctx;

    function init() {
        self.ctx = {payload: (), inboundProperties: {response: new, request: new, uriParams: {}}};
    }

    resource function get vm(http:Request request) returns http:Response|error {
        self.ctx.inboundProperties.request = request;
        return _invokeEndPoint0_(self.ctx);
    }
}

public function _invokeEndPoint0_(Context ctx) returns http:Response|error {

    // set payload
    string _payload0_ = "Hello World";
    ctx.payload = _payload0_;

    // async operation
    _ = start _async0_(ctx);
    log:printInfo("xxx: logger after async block invoked");

    ctx.inboundProperties.response.setPayload(ctx.payload);
    return ctx.inboundProperties.response;
}

public function _vmReceive0_(Context ctx) {
    log:printInfo(string `Received a message: ${ctx.payload.toString()}`);
}

public function _async0_(Context ctx) {
    worker W returns error? {
        // VM Inbound Endpoint
        anydata receivedPayload = <- function;
        ctx.payload = receivedPayload;
        _vmReceive0_(ctx);
    }

    // VM Outbound Endpoint
    ctx.payload -> W;
}

```

- ### Vm Connector Wth Http Source

**Input (vm_connector_wth_http_source.xml):**
```xml
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns:tracking="http://www.mulesoft.org/schema/mule/ee/tracking" xmlns:vm="http://www.mulesoft.org/schema/mule/vm" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/vm http://www.mulesoft.org/schema/mule/vm/current/mule-vm.xsd
http://www.mulesoft.org/schema/mule/ee/tracking http://www.mulesoft.org/schema/mule/ee/tracking/current/mule-tracking-ee.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd">
    <http:listener-config name="HTTP_Listener_Configuration" host="0.0.0.0" port="8081" basePath="/" doc:name="HTTP Listener Configuration"/>
    <flow name="outboundVmFlow">
        <http:listener config-ref="HTTP_Listener_Configuration" path="/vm" allowedMethods="GET" doc:name="HTTP"/>
        <set-payload value="#['Hello World']" doc:name="Set Payload"/>
        <vm:outbound-endpoint exchange-pattern="one-way" path="path-xxx" doc:name="VM"/>
    </flow>
    <flow name="inboundVmFow">
        <vm:inbound-endpoint exchange-pattern="one-way"  doc:name="VM" path="path-xxx"/>
        <logger message="Received a message: #[payload]" level="INFO" doc:name="Logger"/>
    </flow>
</mule>

```
**Output (vm_connector_wth_http_source.bal):**
```ballerina
import ballerina/http;
import ballerina/log;

public type InboundProperties record {|
    http:Response response;
    http:Request request;
    map<string> uriParams;
|};

public type Context record {|
    anydata payload;
    InboundProperties inboundProperties;
|};

public listener http:Listener HTTP_Listener_Configuration = new (8081, {host: "0.0.0.0"});

service / on HTTP_Listener_Configuration {
    Context ctx;

    function init() {
        self.ctx = {payload: (), inboundProperties: {response: new, request: new, uriParams: {}}};
    }

    resource function get vm(http:Request request) returns http:Response|error {
        self.ctx.inboundProperties.request = request;
        return _invokeEndPoint0_(self.ctx);
    }
}

public function _invokeEndPoint0_(Context ctx) returns http:Response|error {
    worker W returns error? {
        // VM Inbound Endpoint
        anydata receivedPayload = <- function;
        ctx.payload = receivedPayload;
        _vmReceive0_(ctx);
    }

    // set payload
    string _payload0_ = "Hello World";
    ctx.payload = _payload0_;

    // VM Outbound Endpoint
    ctx.payload -> W;

    ctx.inboundProperties.response.setPayload(ctx.payload);
    return ctx.inboundProperties.response;
}

public function _vmReceive0_(Context ctx) {
    log:printInfo(string `Received a message: ${ctx.payload.toString()}`);
}

```

